<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instax Wide Photo Printer</title>
    <style>
        /* Base and Reset */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
            line-height: 1.5;
            background-color: #e9e9e9; /* Light gray background for the page "outside" the print area */
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 1rem; /* Padding around the content */
        }

        .controls-container {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05); /* Softer shadow */
            width: 100%;
            max-width: 500px;
            text-align: center;
            margin-bottom: 2rem;
        }

        h1 {
            font-size: 1.6rem;
            color: #2c3e50; /* Darker blue/gray */
            margin-bottom: 0.5rem;
        }
        p {
            color: #555;
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }
        .dimensions-info {
            font-size: 0.8rem;
            color: #777;
            margin-bottom: 1.5rem;
        }

        .btn {
            display: inline-block;
            padding: 0.6rem 1.2rem;
            background: #3498db; /* Brighter blue */
            color: white;
            border: none;
            border-radius: 5px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s;
            text-decoration: none;
        }
        .btn:hover {
            background: #2980b9; /* Darker blue on hover */
        }
        .btn-print {
            background: #2ecc71; /* Green for print */
            margin-top: 1rem;
        }
        .btn-print:hover {
            background: #27ae60; /* Darker green on hover */
        }
        #imageUpload {
            display: none; /* Hidden file input */
        }

        #previewArea {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #uploadPromptText {
            text-align: center;
            margin-top: 1rem;
            margin-bottom: 1rem; /* Ensure space if it reappears */
            color: #777;
        }

        .instax-container {
            position: relative; /* For positioning trim marks */
            width: 108mm; /* Outer dimension of Instax Wide film - Width */
            height: 84mm; /* Outer dimension of Instax Wide film - Height (as per original user code) */
            margin: 0 auto; /* Centered for screen viewing */
            display: none; /* Hidden until image is loaded */
            background-color: white; /* Simulates paper */
            box-shadow: 0 6px 15px rgba(0,0,0,0.1); /* Visual lift on screen */
            /* overflow: visible; is default but ensures trim marks outside are seen */
        }

        .instax-frame {
            width: 100%;
            height: 100%;
            background-color: white; /* Color of the Instax border area */
            /* Padding defines the photo area within the frame: T:8mm, R:5mm, B:16mm, L:5mm */
            /* This results in photo area: Height (84-8-16) = 60mm, Width (108-5-5) = 98mm */
            padding: 8mm 5mm 16mm 5mm;
            border-radius: 0; /* Approx rounded corners of an Instax print */
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden; /* Image clipped to photo area */
            border: 1px dashed #aaa;
        }

        .image-inside {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Cover the photo area, cropping if necessary */
            display: block;
            background-color: #e0e0e0; /* Placeholder bg before image loads */
            /* border-radius: 1mm; /* Optional: slight rounding for the photo corners within the frame */
        }

        /* Trim marks - visible on screen when preview is active */
        .trim-mark {
            position: absolute;
            background-color: #333; /* Dark gray for screen, black for print */
            display: block; /* JS controls parent, so these are shown when parent is */
        }
        .trim-mark-h { height: 1px; width: 10mm; }
        .trim-mark-v { width: 1px; height: 10mm; }

        /* Positioning trim marks to cross the container's edge (original style) */
        .top-left-h { top: 0; left: -5mm; }
        .top-left-v { top: -5mm; left: 0; }
        .top-right-h { top: 0; right: -5mm; }
        .top-right-v { top: -5mm; right: 0; }
        .bottom-left-h { bottom: 0; left: -5mm; }
        .bottom-left-v { bottom: -5mm; left: 0; }
        .bottom-right-h { bottom: 0; right: -5mm; }
        .bottom-right-v { bottom: -5mm; right: 0; }

        /* Print Styles */
        @media print {
            body {
                background-color: white !important;
                padding: 0 !important;
                margin: 0 !important;
                -webkit-print-color-adjust: exact !important; /* Ensure background colors print if any were essential */
                print-color-adjust: exact !important;
            }

            .controls-container, #printButton {
                display: none !important;
            }
            #uploadPromptText { /* Also hide this if it was somehow visible */
                 display: none !important;
            }

            @page {
                margin: 0; /* Remove browser default margins for printing */
                size: auto; /* Use printer's default paper size */
            }

            #previewArea {
                width: 100vw;
                height: 100vh;
                display: flex; /* Center the container on the print page */
                align-items: center;
                justify-content: center;
                padding:0; margin:0;
            }

            .instax-container {
                display: block !important;
                position: relative; /* Use relative for print flow, centering handled by #previewArea flex */
                margin: 0 !important; /* Remove screen margin */
                box-shadow: none !important; /* No shadow for print */
                page-break-inside: avoid !important;
                /* For precise absolute centering on print (alternative to flex on #previewArea): */
                /* position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); */
            }

            .instax-frame {
                box-shadow: none !important;
                border-radius: 0 !important; /* Maintain rounded corners for Instax look */
                border: 1px dashed #aaa !important;
            }

            .trim-mark {
                background-color: #000000 !important; /* Pure black trim marks for print */
            }
            .image-inside {
                 background-color: transparent !important; /* No placeholder bg color on print */
            }
        }
    </style>
</head>
<body>
    <div class="controls-container">
        <h1>Instax Wide Photo Printer</h1>
        <p>Upload your photo. It will be previewed in an Instax Wide style.</p>
        <p class="dimensions-info">
            Frame: 108mm × 84mm. Photo Area (approx): 98mm × 60mm.<br>
            Borders (photo area to frame edge): Top: 8mm, Sides: 5mm, Bottom: 16mm.
        </p>

        <label for="imageUpload" class="btn">
            Upload Image
        </label>
        <input type="file" id="imageUpload" accept="image/*">

        <button id="printButton" class="btn btn-print" style="display: none;">
            Print Photo
        </button>
    </div>

    <div id="previewArea">
        <p id="uploadPromptText">Your photo preview will appear here.</p>
        <div class="instax-container">
            <div class="trim-mark trim-mark-h top-left-h"></div>
            <div class="trim-mark trim-mark-v top-left-v"></div>
            <div class="trim-mark trim-mark-h top-right-h"></div>
            <div class="trim-mark trim-mark-v top-right-v"></div>
            <div class="trim-mark trim-mark-h bottom-left-h"></div>
            <div class="trim-mark trim-mark-v bottom-left-v"></div>
            <div class="trim-mark trim-mark-h bottom-right-h"></div>
            <div class="trim-mark trim-mark-v bottom-right-v"></div>

            <div class="instax-frame">
                <img id="imagePreview" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="Image Preview" class="image-inside">
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const imageUpload = document.getElementById('imageUpload');
            const imagePreview = document.getElementById('imagePreview');
            const instaxContainer = document.querySelector('.instax-container');
            const printButton = document.getElementById('printButton');
            const uploadPromptText = document.getElementById('uploadPromptText');

            imageUpload.addEventListener('change', function(event) {
                const file = event.target.files[0];
                if (file && file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        imagePreview.src = e.target.result;
                        imagePreview.style.backgroundColor = 'transparent';

                        instaxContainer.style.display = 'block';
                        uploadPromptText.style.display = 'none';
                        printButton.style.display = 'inline-block';
                    };
                    reader.readAsDataURL(file);
                } else {
                    // Reset if no file or invalid file
                    imagePreview.src = "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";
                    imagePreview.style.backgroundColor = '#e0e0e0';
                    
                    if (file) { // Invalid file type
                        uploadPromptText.textContent = "Invalid file. Please select an image (e.g., JPG, PNG).";
                        uploadPromptText.style.color = "#e74c3c"; // Error color
                    } else { // No file selected or dialog cancelled
                        uploadPromptText.textContent = "Your photo preview will appear here.";
                        uploadPromptText.style.color = "#777"; // Default color
                    }
                    uploadPromptText.style.display = 'block';
                    instaxContainer.style.display = 'none';
                    printButton.style.display = 'none';
                }
            });

            printButton.addEventListener('click', () => {
                const originalTitle = document.title;
                // Generate a somewhat unique title for the print job if needed
                const filename = imageUpload.files[0] ? imageUpload.files[0].name.split('.')[0] : 'Instax_Print';
                document.title = filename + "_" + new Date().toISOString().slice(0,10);
                
                window.print();
                
                // Restore title after a delay, browser print dialog might block this
                // setTimeout(() => { document.title = originalTitle; }, 2000);
            });
        });
    </script>
</body>
</html>
